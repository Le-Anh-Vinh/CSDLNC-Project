<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="/style/main.css" />
    <link rel="stylesheet" href="/style/base.css" />
    <link rel="stylesheet" href="/style/grid.css" />
    <link rel="stylesheet" href="/style/dish.css" />
    <link rel="stylesheet" href="/style/responsive.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
    />
  </head>
  <body>
    <div class="app">
      <header class="header">
        <div class="grid wide">
          <nav class="header__navbar hide-on-mobile-tablet">
            <ul class="header__navbar-list">
              <li
                class="header__navbar-item header__navbar-item--separate"
              >
                Chăm sóc khách hàng
              </li>
              <li class="header__navbar-item">
                <span class="header__navbar-title--no-pointer">Kết nối</span>

                <a href="" class="header__navbar-icon-link">
                  <i class="header__navbar-icon fab fa-facebook"></i>
                </a>
                <a href="" class="header__navbar-icon-link">
                  <i class="header__navbar-icon fab fa-instagram"></i>
                </a>
              </li>
            </ul>
            <ul class="header__navbar-list">
              <li class="header__navbar-item">
                <a href="/booked" class="header__navbar-item-non-link">
                  <i class="header__navbar-icon fas fa-check-circle"></i>
                  Check Table Reservation
                </a>
              </li> 
              <li class="header__navbar-item">
                <a href="/employee/spot" class="header__navbar-item-non-link">
                  <i class="header__navbar-icon fas fa-check-circle"></i>
                  Confirm Spot Order
                </a>
              </li> 
              <li class="header__navbar-item">
                <a href="/employee/online" class="header__navbar-item-non-link">
                  <i class="header__navbar-icon fas fa-check-circle"></i>
                  Confirm Online Order
                </a>
              </li>              
              <li class="header__navbar-item">
                <a href="/cart" class="header__navbar-item-non-link">
                  <i class="header__navbar-icon fas fa-shopping-cart"></i>
                    Cart
                </a>
              </li>
              <li class="header__navbar-item header__navbar-user">
                <img
                  src="/img/user_img.png"
                  alt="avatar"
                  class="header__navbar-user-img"
                />

                <span class="header__navbar-user-name">
                  User
                </span>

                <ul class="header__navbar-user-menu">
                  <li class="header__navbar-user-item">
                    <a href="">Tài khoản của tôi</a>
                  </li>
                  <li class="header__navbar-user-item">
                    <a href="">Địa chỉ của tôi</a>
                  </li>
                  <li class="header__navbar-user-item">
                    <a href="">Đơn mua</a>
                  </li>
                  <li
                    class="header__navbar-user-item header__navbar-user-item--separate"
                  >
                    <a href="">Đăng xuất</a>
                  </li>
                </ul>
              </li>
            </ul>
          </nav>

          <!-- Header with Search -->
          <div class="header-with-search">
            <label for="mobile-search-checkbox" class="header__mobile-search">
              <i class="header__mobile-search-icon fas fa-search"></i>
            </label>

            <!-- Header Logo -->
            <div class="header__logo hide-on-tablet">
                <a href="/" class="header__logo-link">
                <img class="header__logo-img" src="/img/logo_img.png" alt="Custom Logo">
                </a>
            </div>
            <input
              type="checkbox"
              hidden
              id="mobile-search-checkbox"
              class="header__search-checkbox"
            />
            <!-- Header Search -->
            <div class="header__search">
              <div class="header__search-input-wrap">
                <input
                  type="text"
                  id="search-input"
                  class="header__search-input"
                  placeholder="Search"
                />
              </div>
              
              <button id="search-btn" class="header__search-btn">
                <i class="header__search-btn-icon fas fa-search"></i>
              </button>
            </div>
            
            <div id="search-results"></div>
          </div>
        </div>
      </header>
      
      <div class="app__container">
        <div class="grid wide">
          <div class="row sm-gutter app__content">
            <div class="col l-12 m-12 c-12">

              <!-- Product -->
              <div class="menu-list">
                <div class="menu-list">
                  <% dishes.forEach(dish => { %>
                    <a href="#" class="menu-item" data-dish-id="<%= dish.MaMA %>">
                        <span class="dish-name"><%= dish.TenMA %></span>
                        <span class="dish-description"><%= dish.MoTa %></span>
                        <span class="dish-price"><%= dish.GiaMA %> VND</span>
                        <div class="quantity-control">
                            <button class="decrease">-</button>
                            <span class="quantity">0</span>
                            <button class="increase">+</button>
                        </div>
                    </a>
                <% }); %>
                </div>
              </div>
              
            </div>
          </div>
        </div>
      </div>
      <!-- Footer -->
      <footer class="footer">
        <div class="grid wide footer__content">
          <div class="row">
            <div class="col l-2-8 m-4 c-6">
              <h3 class="footer__heading">CHĂM SÓC KHÁCH HÀNG</h3>
              <ul class="footer-list">
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Trung Tâm Trợ Giúp</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Hướng Dẫn Mua Hàng</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link"
                    >Chính Sách Vận Chuyển</a
                  >
                </li>
              </ul>
            </div>
            <div class="col l-2-8 m-4 c-6">
              <h3 class="footer__heading">VỀ CHÚNG TÔI</h3>
              <ul class="footer-list">
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Giới Thiệu Về Shop</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Tuyển Dụng</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Điều Khoản Shop</a>
                </li>
              </ul>
            </div>
            <div class="col l-2-4 m-8 c-12">
              <h3 class="footer__heading">ĐỊA CHỈ CỦA TRANG WEB</h3>
              <div class="footer__download">
                <img
                  src="/img/qr_code.png"
                  alt="Download QR"
                  class="footer__dowload-qr"
                />
              </div>
            </div>
          </div>
        </div>
        <div class="footer__bottom">
          <div class="grid wide">
            <p class="footer__text">
              © 2024 Triết lí cuộc sống - Đời là bể khổ, qua được bể khổ là qua đời
            </p>
          </div>
        </div>
      </footer>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
          const menuItems = document.querySelectorAll('.menu-item');

          menuItems.forEach(item => {
              const decreaseButton = item.querySelector('.decrease');
              const increaseButton = item.querySelector('.increase');
              const quantitySpan = item.querySelector('.quantity');
              const dishId = item.getAttribute('data-dish-id');

              decreaseButton.addEventListener('click', async () => {
                  let currentQuantity = parseInt(quantitySpan.textContent, 10);
                  if (currentQuantity > 0) {
                      currentQuantity -= 1;
                      quantitySpan.textContent = currentQuantity;

                      if (currentQuantity === 0) {
                          // Send DELETE request to /cart
                          await fetch('/cart', {
                              method: 'DELETE',
                              headers: {
                                  'Content-Type': 'application/json',
                              },
                              body: JSON.stringify({ dishID: dishId }),
                          });
                      } else {
                          // Send POST request to /cart with updated quantity
                          await fetch('/cart', {
                              method: 'POST',
                              headers: {
                                  'Content-Type': 'application/json',
                              },
                              body: JSON.stringify({ dishID: dishId, quantity: currentQuantity }),
                          });
                      }
                  }
              });

              increaseButton.addEventListener('click', async () => {
                  let currentQuantity = parseInt(quantitySpan.textContent, 10);
                  currentQuantity += 1;
                  quantitySpan.textContent = currentQuantity;

                  // Send POST request to /cart with updated quantity
                  await fetch('/cart', {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json',
                      },
                      body: JSON.stringify({ dishID: dishId, quantity: currentQuantity }),
                  });
              });
          });
      });
      document.getElementById('search-btn').addEventListener('click', async () => {
        const keyword = document.getElementById('search-input').value.trim();
        if (keyword) {
          try {
            window.location.href = `/search?keyword=${encodeURIComponent(keyword)}`;
          } catch (error) {
            console.error('Error fetching search results:', error);
          }
        }
      });
  </script>
  </body>
</html>

<!-- document.addEventListener('DOMContentLoaded', () => {
  const menuItems = document.querySelectorAll('.menu-item');

  menuItems.forEach(item => {
    const decreaseButton = item.querySelector('.decrease');
    const increaseButton = item.querySelector('.increase');
    const quantitySpan = item.querySelector('.quantity');

    decreaseButton.addEventListener('click', () => {
      let currentQuantity = parseInt(quantitySpan.textContent, 10);
      if (currentQuantity > 1) {
        quantitySpan.textContent = currentQuantity - 1;
      }
    });

    increaseButton.addEventListener('click', () => {
      let currentQuantity = parseInt(quantitySpan.textContent, 10);
      quantitySpan.textContent = currentQuantity + 1;
    });
  });
}); -->
